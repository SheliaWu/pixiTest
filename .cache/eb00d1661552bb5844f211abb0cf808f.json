{"dependencies":[{"name":"I:\\nap\\pixi\\package.json","includedInParent":true,"mtime":1520872037604},{"name":"I:\\nap\\pixi\\.babelrc","includedInParent":true,"mtime":1520870313510},{"name":"I:\\nap\\pixi\\node_modules\\pixi.js\\package.json","includedInParent":true,"mtime":1516219849000},{"name":"../utils","loc":{"line":5,"column":21}},{"name":"../settings","loc":{"line":7,"column":24}},{"name":"eventemitter3","loc":{"line":11,"column":28}},{"name":"../utils/determineCrossOrigin","loc":{"line":15,"column":36}},{"name":"bit-twiddle","loc":{"line":19,"column":26}}],"generated":{"js":"\"use strict\";exports.__esModule=!0;var e=require(\"../utils\"),t=require(\"../settings\"),i=h(t),r=require(\"eventemitter3\"),o=h(r),s=require(\"../utils/determineCrossOrigin\"),a=h(s),n=require(\"bit-twiddle\"),u=h(n);function h(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function l(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}function c(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var g=function(t){function r(o,s,a){d(this,r);var n=l(this,t.call(this));return n.uid=(0,e.uid)(),n.touched=0,n.resolution=a||i.default.RESOLUTION,n.width=100,n.height=100,n.realWidth=100,n.realHeight=100,n.scaleMode=void 0!==s?s:i.default.SCALE_MODE,n.hasLoaded=!1,n.isLoading=!1,n.source=null,n.origSource=null,n.imageType=null,n.sourceScale=1,n.premultipliedAlpha=!0,n.imageUrl=null,n.isPowerOfTwo=!1,n.mipmap=i.default.MIPMAP_TEXTURES,n.wrapMode=i.default.WRAP_MODE,n._glTextures={},n._enabled=0,n._virtalBoundId=-1,n._destroyed=!1,n.textureCacheIds=[],o&&n.loadSource(o),n}return c(r,t),r.prototype.update=function(){\"svg\"!==this.imageType&&(this.realWidth=this.source.naturalWidth||this.source.videoWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.videoHeight||this.source.height,this._updateDimensions()),this.emit(\"update\",this)},r.prototype._updateDimensions=function(){this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,this.isPowerOfTwo=u.default.isPow2(this.realWidth)&&u.default.isPow2(this.realHeight)},r.prototype.loadSource=function(e){var t=this.isLoading;this.hasLoaded=!1,this.isLoading=!1,t&&this.source&&(this.source.onload=null,this.source.onerror=null);var i=!this.source;if(this.source=e,(e.src&&e.complete||e.getContext)&&e.width&&e.height)this._updateImageType(),\"svg\"===this.imageType?this._loadSvgSource():this._sourceLoaded(),i&&this.emit(\"loaded\",this);else if(!e.getContext){this.isLoading=!0;var r=this;if(e.onload=function(){r._updateImageType(),e.onload=null,e.onerror=null,r.isLoading&&(r.isLoading=!1,r._sourceLoaded(),\"svg\"!==r.imageType?r.emit(\"loaded\",r):r._loadSvgSource())},e.onerror=function(){e.onload=null,e.onerror=null,r.isLoading&&(r.isLoading=!1,r.emit(\"error\",r))},e.complete&&e.src){if(e.onload=null,e.onerror=null,\"svg\"===r.imageType)return void r._loadSvgSource();this.isLoading=!1,e.width&&e.height?(this._sourceLoaded(),t&&this.emit(\"loaded\",this)):t&&this.emit(\"error\",this)}}},r.prototype._updateImageType=function(){if(this.imageUrl){var t=(0,e.decomposeDataUri)(this.imageUrl),i=void 0;if(t&&\"image\"===t.mediaType){var r=t.subType.split(\"+\")[0];if(!(i=(0,e.getUrlFileExtension)(\".\"+r)))throw new Error(\"Invalid image type in data URI.\")}else(i=(0,e.getUrlFileExtension)(this.imageUrl))||(i=\"png\");this.imageType=i}},r.prototype._loadSvgSource=function(){if(\"svg\"===this.imageType){var t=(0,e.decomposeDataUri)(this.imageUrl);t?this._loadSvgSourceUsingDataUri(t):this._loadSvgSourceUsingXhr()}},r.prototype._loadSvgSourceUsingDataUri=function(e){var t=void 0;if(\"base64\"===e.encoding){if(!atob)throw new Error(\"Your browser doesn't support base64 conversions.\");t=atob(e.data)}else t=e.data;this._loadSvgSourceUsingString(t)},r.prototype._loadSvgSourceUsingXhr=function(){var e=this,t=new XMLHttpRequest;t.onload=function(){if(t.readyState!==t.DONE||200!==t.status)throw new Error(\"Failed to load SVG using XHR.\");e._loadSvgSourceUsingString(t.response)},t.onerror=function(){return e.emit(\"error\",e)},t.open(\"GET\",this.imageUrl,!0),t.send()},r.prototype._loadSvgSourceUsingString=function(t){var i=(0,e.getSvgSize)(t),o=i.width,s=i.height;if(!o||!s)throw new Error(\"The SVG image must have width and height defined (in pixels), canvas API needs them.\");this.realWidth=Math.round(o*this.sourceScale),this.realHeight=Math.round(s*this.sourceScale),this._updateDimensions();var a=document.createElement(\"canvas\");a.width=this.realWidth,a.height=this.realHeight,a._pixiId=\"canvas_\"+(0,e.uid)(),a.getContext(\"2d\").drawImage(this.source,0,0,o,s,0,0,this.realWidth,this.realHeight),this.origSource=this.source,this.source=a,r.addToCache(this,a._pixiId),this.isLoading=!1,this._sourceLoaded(),this.emit(\"loaded\",this)},r.prototype._sourceLoaded=function(){this.hasLoaded=!0,this.update()},r.prototype.destroy=function(){this.imageUrl&&(delete e.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src=\"\")),this.source=null,this.dispose(),r.removeFromCache(this),this.textureCacheIds=null,this._destroyed=!0},r.prototype.dispose=function(){this.emit(\"dispose\",this)},r.prototype.updateSourceImage=function(e){this.source.src=e,this.loadSource(this.source)},r.fromImage=function(t,i,o,s){var n=e.BaseTextureCache[t];if(!n){var u=new Image;void 0===i&&0!==t.indexOf(\"data:\")?u.crossOrigin=(0,a.default)(t):i&&(u.crossOrigin=\"string\"==typeof i?i:\"anonymous\"),(n=new r(u,o)).imageUrl=t,s&&(n.sourceScale=s),n.resolution=(0,e.getResolutionOfUrl)(t),u.src=t,r.addToCache(n,t)}return n},r.fromCanvas=function(t,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:\"canvas\";t._pixiId||(t._pixiId=o+\"_\"+(0,e.uid)());var s=e.BaseTextureCache[t._pixiId];return s||(s=new r(t,i),r.addToCache(s,t._pixiId)),s},r.from=function(t,i,o){if(\"string\"==typeof t)return r.fromImage(t,void 0,i,o);if(t instanceof HTMLImageElement){var s=t.src,a=e.BaseTextureCache[s];return a||((a=new r(t,i)).imageUrl=s,o&&(a.sourceScale=o),a.resolution=(0,e.getResolutionOfUrl)(s),r.addToCache(a,s)),a}return t instanceof HTMLCanvasElement?r.fromCanvas(t,i):t},r.addToCache=function(t,i){i&&(-1===t.textureCacheIds.indexOf(i)&&t.textureCacheIds.push(i),e.BaseTextureCache[i]&&console.warn(\"BaseTexture added to the cache with an id [\"+i+\"] that already had an entry\"),e.BaseTextureCache[i]=t)},r.removeFromCache=function(t){if(\"string\"==typeof t){var i=e.BaseTextureCache[t];if(i){var r=i.textureCacheIds.indexOf(t);return r>-1&&i.textureCacheIds.splice(r,1),delete e.BaseTextureCache[t],i}}else if(t&&t.textureCacheIds){for(var o=0;o<t.textureCacheIds.length;++o)delete e.BaseTextureCache[t.textureCacheIds[o]];return t.textureCacheIds.length=0,t}return null},r}(o.default);exports.default=g;"},"hash":"dc9d715aa0ab470d13a05ec5400014c2","cacheData":{"env":{}}}